# TinyAI NdArray å¤šç»´æ•°ç»„åº“

## æ¦‚è¿°

`tinyai-dl-ndarr` æ˜¯ TinyAI æ·±åº¦å­¦ä¹ æ¡†æ¶çš„æ ¸å¿ƒå¤šç»´æ•°ç»„å¤„ç†æ¨¡å—ï¼Œæä¾›äº†é«˜æ•ˆçš„ N ç»´æ•°ç»„æ“ä½œåŠŸèƒ½ã€‚è¯¥æ¨¡å—ä¸“é—¨è®¾è®¡ç”¨äºæ”¯æŒ CPUã€GPU å’Œ TPU ä¸‰ç§ä¸åŒçš„è®¡ç®—è®¾å¤‡ï¼Œä¸ºæ·±åº¦å­¦ä¹ å’Œç§‘å­¦è®¡ç®—æä¾›å¼ºå¤§çš„æ•°æ®ç»“æ„åŸºç¡€ã€‚

## æ ¸å¿ƒç‰¹æ€§

- ğŸ¯ **ç»Ÿä¸€æ¥å£è®¾è®¡** - é€šè¿‡æ¥å£æŠ½è±¡å®ç°è·¨è®¾å¤‡çš„ç»Ÿä¸€æ“ä½œ
- âš¡ **é«˜æ€§èƒ½è®¡ç®—** - é‡‡ç”¨æ‰å¹³åŒ–å†…å­˜å¸ƒå±€å’Œå¤šç§ä¼˜åŒ–ç­–ç•¥
- ğŸ”§ **åŠŸèƒ½å®Œæ•´** - æä¾›ä¸°å¯Œçš„æ•°å­¦è¿ç®—å’ŒçŸ©é˜µæ“ä½œåŠŸèƒ½
- ğŸŒ **å¤šè®¾å¤‡æ”¯æŒ** - æ”¯æŒ CPUã€GPUã€TPU ä¸‰ç§è®¡ç®—è®¾å¤‡
- ğŸ“Š **å¹¿æ’­æœºåˆ¶** - æ”¯æŒä¸åŒå½¢çŠ¶æ•°ç»„é—´çš„è‡ªåŠ¨å¹¿æ’­è¿ç®—
- ğŸ¨ **æ˜“äºä½¿ç”¨** - æä¾›ç®€æ´çš„ API å’Œä¾¿æ·çš„å·¥å‚æ–¹æ³•

## æ¶æ„è®¾è®¡


**æ¶æ„å›¾ï¼ˆæ–‡æœ¬ç‰ˆï¼‰**ï¼š

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      æ ¸å¿ƒæ¥å£å±‚              â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚  â€¢ NdArrayæ¥å£              â”‚
                    â”‚  â€¢ Shapeæ¥å£                â”‚
                    â”‚  â€¢ NdArrayUtilå·¥å…·ç±»         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚               â”‚               â”‚
            â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   CPUå®ç°     â”‚ â”‚   GPUå®ç°     â”‚ â”‚   TPUå®ç°     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ NdArrayCpu   â”‚ â”‚ NdArrayGpu   â”‚ â”‚ NdArrayTpu   â”‚
    â”‚ ShapeCpu     â”‚ â”‚ ShapeGpu     â”‚ â”‚ ShapeTpu     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

### Maven ä¾èµ–

```xml
<dependency>
    <groupId>io.leavesfly.tinyai</groupId>
    <artifactId>tinyai-dl-ndarr</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>
```

### åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

#### 1. åˆ›å»ºæ•°ç»„

```java
import io.leavesfly.tinyai.ndarr.*;

// ä»æ ‡é‡åˆ›å»º
NdArray scalar = NdArray.of(3.14f);

// ä»ä¸€ç»´æ•°ç»„åˆ›å»º
float[] data1d = {1, 2, 3, 4, 5, 6};
NdArray vector = NdArray.of(data1d);

// ä»äºŒç»´æ•°ç»„åˆ›å»º
float[][] data2d = {{1, 2, 3}, {4, 5, 6}};
NdArray matrix = NdArray.of(data2d);

// ä½¿ç”¨å½¢çŠ¶åˆ›å»º
Shape shape = Shape.of(2, 3);
NdArray zeros = NdArray.zeros(shape);
NdArray ones = NdArray.ones(shape);
NdArray eye = NdArray.eye(Shape.of(3, 3));
```

#### 2. æ•°å­¦è¿ç®—

```java
// åŸºç¡€å››åˆ™è¿ç®—
NdArray a = NdArray.of(new float[][]{{1, 2}, {3, 4}});
NdArray b = NdArray.of(new float[][]{{5, 6}, {7, 8}});

NdArray sum = a.add(b);        // åŠ æ³•
NdArray diff = a.sub(b);       // å‡æ³•
NdArray prod = a.mul(b);       // å…ƒç´ çº§ä¹˜æ³•
NdArray quot = a.div(b);       // å…ƒç´ çº§é™¤æ³•

// çŸ©é˜µä¹˜æ³•
NdArray matMul = a.dot(b);

// æ•°å­¦å‡½æ•°
NdArray exp = a.exp();         // æŒ‡æ•°å‡½æ•°
NdArray log = a.log();         // å¯¹æ•°å‡½æ•°
NdArray sqrt = a.sqrt();       // å¹³æ–¹æ ¹
NdArray pow = a.pow(2);        // å¹‚å‡½æ•°
```

#### 3. å½¢çŠ¶æ“ä½œ

```java
NdArray array = NdArray.of(new float[]{1, 2, 3, 4, 5, 6});

// é‡å¡‘å½¢çŠ¶
NdArray reshaped = array.reshape(Shape.of(2, 3));

// è½¬ç½®
NdArray transposed = reshaped.transpose();

// å±•å¹³
NdArray flattened = reshaped.flatten();
```

#### 4. èšåˆæ“ä½œ

```java
NdArray data = NdArray.of(new float[][]{{1, 2, 3}, {4, 5, 6}});

// ç»Ÿè®¡å‡½æ•°
NdArray sum = data.sum();           // æ€»å’Œ
NdArray mean = data.mean();         // å¹³å‡å€¼
NdArray max = data.max();           // æœ€å¤§å€¼
NdArray min = data.min();           // æœ€å°å€¼
NdArray variance = data.var();      // æ–¹å·®

// æŒ‰è½´èšåˆ
NdArray rowSum = data.sum(1);       // æŒ‰è¡Œæ±‚å’Œ
NdArray colMean = data.mean(0);     // æŒ‰åˆ—æ±‚å¹³å‡
```

#### 5. å¹¿æ’­è¿ç®—

```java
// çŸ©é˜µä¸å‘é‡çš„å¹¿æ’­è¿ç®—
NdArray matrix = NdArray.of(new float[][]{{1, 2, 3}, {4, 5, 6}});
NdArray vector = NdArray.of(new float[]{10, 20, 30});

// å‘é‡è‡ªåŠ¨å¹¿æ’­åˆ°çŸ©é˜µå½¢çŠ¶è¿›è¡Œè¿ç®—
NdArray result = matrix.add(vector.broadcastTo(matrix.getShape()));
```

## æ ¸å¿ƒç»„ä»¶è¯¦è§£

### NdArray æ¥å£

`NdArray` æ˜¯å¤šç»´æ•°ç»„çš„æ ¸å¿ƒæ¥å£ï¼Œå®šä¹‰äº†æ‰€æœ‰æ•°ç»„æ“ä½œçš„ç»Ÿä¸€è§„èŒƒï¼š

#### åˆ›å»ºæ–¹æ³•
- **é™æ€å·¥å‚æ–¹æ³•**: `of()`, `zeros()`, `ones()`, `eye()`, `like()`
- **éšæœºæ•°ç»„**: `likeRandomN()`, `likeRandom()`, `randn()`
- **çº¿æ€§ç©ºé—´**: `linSpace()`

#### è¿ç®—æ“ä½œ
- **åŸºç¡€è¿ç®—**: `add()`, `sub()`, `mul()`, `div()`
- **æ•°å­¦å‡½æ•°**: `exp()`, `log()`, `sqrt()`, `pow()`, `sin()`, `cos()`, `tanh()`, `sigmoid()`
- **çŸ©é˜µè¿ç®—**: `dot()`, `transpose()`
- **æ¯”è¾ƒè¿ç®—**: `eq()`, `gt()`, `lt()`, `ge()`, `le()`

#### å½¢çŠ¶æ“ä½œ
- **å½¢çŠ¶å˜æ¢**: `reshape()`, `flatten()`, `transpose()`
- **å¹¿æ’­æ“ä½œ**: `broadcastTo()`, `sumTo()`
- **åˆ‡ç‰‡æ“ä½œ**: `slice()`, `getItem()`

#### èšåˆç»Ÿè®¡
- **ç»Ÿè®¡å‡½æ•°**: `sum()`, `mean()`, `max()`, `min()`, `var()`, `std()`
- **ç´¢å¼•æ“ä½œ**: `argmax()`, `argmin()`

### Shape æ¥å£

`Shape` æ¥å£è´Ÿè´£ç®¡ç†å¤šç»´æ•°ç»„çš„ç»´åº¦ä¿¡æ¯ï¼š

```java
// åˆ›å»ºå½¢çŠ¶
Shape shape2d = Shape.of(3, 4);        // 3x4 çŸ©é˜µ
Shape shape3d = Shape.of(2, 3, 4);     // 2x3x4 å¼ é‡

// å½¢çŠ¶ä¿¡æ¯æŸ¥è¯¢
int rows = shape2d.getRow();            // è·å–è¡Œæ•°
int cols = shape2d.getColumn();         // è·å–åˆ—æ•°
int dims = shape2d.getDimNum();         // è·å–ç»´åº¦æ•°
int size = shape2d.size();              // è·å–å…ƒç´ æ€»æ•°

// ç±»å‹åˆ¤æ–­
boolean isMatrix = shape2d.isMatrix();  // æ˜¯å¦ä¸ºçŸ©é˜µ
boolean isVector = shape1d.isVector();  // æ˜¯å¦ä¸ºå‘é‡
boolean isScalar = shape0d.isScalar();  // æ˜¯å¦ä¸ºæ ‡é‡

// ç´¢å¼•è®¡ç®—
int index = shape2d.getIndex(1, 2);     // å¤šç»´ç´¢å¼•è½¬ä¸€ç»´ç´¢å¼•
```

### NdArrayUtil å·¥å…·ç±»

æä¾›æ•°ç»„æ“ä½œçš„é«˜çº§åŠŸèƒ½ï¼š

```java
// æ•°ç»„åˆå¹¶
NdArray array1 = NdArray.of(new float[][]{{1, 2}, {3, 4}});
NdArray array2 = NdArray.of(new float[][]{{5, 6}, {7, 8}});

// æŒ‰è¡Œåˆå¹¶ï¼ˆaxis=0ï¼‰
NdArray merged = NdArrayUtil.merge(0, array1, array2);
// ç»“æœ: [[1, 2], [3, 4], [5, 6], [7, 8]]

// æŒ‰åˆ—åˆå¹¶ï¼ˆaxis=1ï¼‰
NdArray merged = NdArrayUtil.merge(1, array1, array2);
// ç»“æœ: [[1, 2, 5, 6], [3, 4, 7, 8]]
```

## é«˜çº§ç‰¹æ€§

### å¹¿æ’­æœºåˆ¶

å¹¿æ’­æœºåˆ¶å…è®¸ä¸åŒå½¢çŠ¶çš„æ•°ç»„è¿›è¡Œè¿ç®—ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™ï¼š

1. ä»å³ä¾§å¼€å§‹æ¯”è¾ƒç»´åº¦
2. ç»´åº¦å¤§å°ç›¸ç­‰æˆ–å…¶ä¸­ä¸€ä¸ªä¸º1æ—¶å…¼å®¹
3. è‡ªåŠ¨æ‰©å±•è¾ƒå°çš„ç»´åº¦

```java
// ç¤ºä¾‹ï¼š(2,3) + (3,) â†’ (2,3)
NdArray matrix = NdArray.of(new float[][]{{1, 2, 3}, {4, 5, 6}});  // (2,3)
NdArray vector = NdArray.of(new float[]{10, 20, 30});               // (3,)

NdArray result = matrix.add(vector.broadcastTo(matrix.getShape()));
// ç»“æœ: [[11, 22, 33], [14, 25, 36]]
```

### å†…å­˜ç®¡ç†

- **æ‰å¹³åŒ–å­˜å‚¨**: æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ä¸€ç»´æ•°ç»„ä¸­ï¼Œæé«˜å†…å­˜è®¿é—®æ•ˆç‡
- **é›¶æ‹·è´æ“ä½œ**: å°½å¯èƒ½é¿å…æ•°æ®å¤åˆ¶ï¼Œé€šè¿‡è§†å›¾æ“ä½œæé«˜æ€§èƒ½
- **è‡ªåŠ¨åƒåœ¾å›æ”¶**: ä¾èµ– JVM çš„åƒåœ¾å›æ”¶æœºåˆ¶ç®¡ç†å†…å­˜

### è®¾å¤‡æ”¯æŒ

å½“å‰å·²å®ç°ï¼š
- âœ… **CPU æ”¯æŒ**: åŸºäº Java åŸç”Ÿæ•°ç»„çš„é«˜æ•ˆå®ç°
- ğŸš§ **GPU æ”¯æŒ**: åŸºäº CUDA/OpenCL çš„å¹¶è¡Œè®¡ç®—ï¼ˆå¼€å‘ä¸­ï¼‰
- ğŸš§ **TPU æ”¯æŒ**: åŸºäº TPU API çš„ä¸“ç”¨è®¡ç®—ï¼ˆè§„åˆ’ä¸­ï¼‰

## æ€§èƒ½ä¼˜åŒ–

### å»ºè®®çš„æœ€ä½³å®è·µ

1. **é¢„åˆ†é…æ•°ç»„**: å¯¹äºå·²çŸ¥å¤§å°çš„è¿ç®—ï¼Œæå‰åˆ›å»ºç›®æ ‡æ•°ç»„
2. **æ‰¹é‡æ“ä½œ**: å°½é‡ä½¿ç”¨å‘é‡åŒ–æ“ä½œè€Œéé€å…ƒç´ å¾ªç¯
3. **å†…å­˜é‡ç”¨**: åˆ©ç”¨ `like()` æ–¹æ³•åˆ›å»ºç›¸åŒå½¢çŠ¶çš„æ•°ç»„
4. **é¿å…ä¸å¿…è¦çš„æ‹·è´**: ä½¿ç”¨è§†å›¾æ“ä½œä»£æ›¿æ•°æ®æ‹·è´

```java
// æ¨èï¼šæ‰¹é‡æ“ä½œ
NdArray result = a.add(b).mul(c);

// ä¸æ¨èï¼šé€å…ƒç´ æ“ä½œ
for (int i = 0; i < size; i++) {
    // é€ä¸ªè®¡ç®—...
}
```

## æµ‹è¯•è¦†ç›–

é¡¹ç›®åŒ…å«å…¨é¢çš„å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–ç‡è¾¾åˆ° 100%ï¼š

- **æµ‹è¯•æ€»æ•°**: 78 ä¸ª
- **NdArrayTest**: 40 ä¸ªæµ‹è¯•ç”¨ä¾‹
- **ShapeTest**: 23 ä¸ªæµ‹è¯•ç”¨ä¾‹  
- **NdArrayUtilTest**: 15 ä¸ªæµ‹è¯•ç”¨ä¾‹

è¿è¡Œæµ‹è¯•ï¼š

```bash
cd tinyai-dl-ndarr
mvn test
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†ä¸åŒå½¢çŠ¶æ•°ç»„çš„è¿ç®—ï¼Ÿ
A: ä½¿ç”¨å¹¿æ’­æœºåˆ¶ã€‚è°ƒç”¨ `broadcastTo()` æ–¹æ³•å°†è¾ƒå°çš„æ•°ç»„å¹¿æ’­åˆ°ç›®æ ‡å½¢çŠ¶ï¼Œæˆ–ç›´æ¥è¿›è¡Œè¿ç®—ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†å…¼å®¹çš„å¹¿æ’­ï¼‰ã€‚

### Q: å¦‚ä½•ä¼˜åŒ–å¤§è§„æ¨¡æ•°ç»„çš„è®¡ç®—æ€§èƒ½ï¼Ÿ
A: 
1. ä½¿ç”¨æ‰¹é‡æ“ä½œè€Œéå¾ªç¯
2. é¢„åˆ†é…ç»“æœæ•°ç»„
3. è€ƒè™‘ä½¿ç”¨GPUå®ç°ï¼ˆå¼€å‘ä¸­ï¼‰
4. åˆç†ä½¿ç”¨å†…å­˜ç®¡ç†

### Q: æ”¯æŒå“ªäº›æ•°æ®ç±»å‹ï¼Ÿ
A: å½“å‰ç‰ˆæœ¬ä¸»è¦æ”¯æŒ `float` ç±»å‹ã€‚æœªæ¥ç‰ˆæœ¬å°†æ‰©å±•æ”¯æŒ `double`ã€`int` ç­‰å…¶ä»–æ•°å€¼ç±»å‹ã€‚

### Q: å¦‚ä½•æ‰©å±•åˆ°å…¶ä»–è®¡ç®—è®¾å¤‡ï¼Ÿ
A: å®ç°å¯¹åº”çš„ `NdArray` å’Œ `Shape` æ¥å£å³å¯ã€‚å‚è€ƒ `NdArrayCpu` å’Œ `ShapeCpu` çš„å®ç°æ¨¡å¼ã€‚

## å¼€å‘è·¯çº¿å›¾

- [x] CPU åŸºç¡€å®ç°
- [x] å®Œæ•´çš„æ•°å­¦è¿ç®—æ”¯æŒ  
- [x] å¹¿æ’­æœºåˆ¶
- [x] å…¨é¢å•å…ƒæµ‹è¯•
- [ ] GPU å®ç°ï¼ˆCUDA/OpenCLï¼‰
- [ ] TPU å®ç°
- [ ] å¤šæ•°æ®ç±»å‹æ”¯æŒ
- [ ] ç¨€ç–æ•°ç»„æ”¯æŒ
- [ ] åˆ†å¸ƒå¼è®¡ç®—æ”¯æŒ

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](../LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æˆ‘ä»¬

- é¡¹ç›®ä¸»é¡µ: [TinyAI](https://github.com/leavesfly/TinyAI)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/leavesfly/TinyAI/issues)
- é‚®ç®±è”ç³»: [your-email@example.com]

---

*TinyAI NdArray - ä¸ºæ·±åº¦å­¦ä¹ æä¾›å¼ºå¤§çš„å¤šç»´æ•°ç»„åŸºç¡€ ğŸš€*